{% extends 'base.html' %}

{% block filtre %}
{% if user.is_authenticated %}
<div class="d-flex flex-row">

  <!-- Bouton sidebar -->
  <button class="btn btn-outline-light custom-btn m-3" id="sidebarToggleBtn" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar">
    â˜°
  </button>

  <!-- Sidebar -->
  <div class="bg-dark text-white vh-100 p-3 collapse" id="sidebar">
    <button class="btn btn-outline-light m-3" id="toggleSidebarBtn" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar">
      â˜°
    </button>
    <ul class="nav nav-pills flex-column">
      <li><a class="nav-link text-white" href="{% url 'home' %}">ğŸ  Accueil</a></li>
      <li><a class="nav-link text-white" href="#">ğŸ“Š Tableau de bord</a></li>
      <li><a class="nav-link text-white" href="#">ğŸ›’ Commandes</a></li>
    </ul>
  </div>

  <!-- Contenu principal -->
  <div class="flex-grow-1">

    <!-- Formulaire de recherche -->
    <div class="d-flex justify-content-center align-items-center mt-3">
      <form class="d-flex" method="get" action="">
        <input name="searchValue" class="form-control me-2" style="width: 250px;" value="{{ search_value|default:'' }}" placeholder="Rechercher...">
        <button type="submit" class="btn btn-primary">Rechercher</button>
      </form>
    </div>

    <!-- Options et boutons alignÃ©s Ã  droite -->
<div class="d-flex align-items-center gap-3 mt-3 ms-auto justify-content-end flex-wrap">

  <!-- Total -->
  <p class="lead mb-0 me-3">Total : {{ record_count }}</p>

  <!-- Ã‰lÃ©ments par page -->
  <div class="d-flex align-items-center me-3">
    <label for="elementsPerPage" class="me-2 mb-0">Ã‰lÃ©ments par page :</label>
    <select id="elementsPerPage" class="form-select form-select-sm">
      <option value="1">1</option>
      <option value="3">3</option>
      <option value="10">10</option>
      <option value="25">25</option>
      <option value="50">50</option>
      <option value="100">100</option>
    </select>
  </div>

  <!-- Bouton Ajouter -->
  {% if table == 'table1' %}
    <a href="{% url 'add_record' %}?table=table1" class="btn btn-success me-2">Ajouter</a>
  {% elif table == 'table2' %}
    <a href="{% url 'add_record' %}?table=table2" class="btn btn-success me-2">Ajouter</a>
  {% endif %}

  <!-- Menu Export -->
  <div class="dropdown export-dropdown">
    <a class="btn btn-secondary dropdown-toggle" type="button" id="exportDropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      Exporter
    </a>
    <ul class="dropdown-menu dropdown-left" aria-labelledby="exportDropdown">
      <li>
        <a class="dropdown-item" href="{% url 'export_csv' %}?table={{ request.GET.table|default:'table1' }}&searchValue={{ request.GET.searchValue|default:'' }}&page={{ request.GET.page|default:1 }}&elementsPerPage={{ request.GET.elementsPerPage|default:10 }}">
          Exporter CSV
        </a>
      </li>
      <li>
        <a class="dropdown-item" href="{% url 'export_excel' %}?table={{ request.GET.table|default:'table1' }}&searchValue={{ request.GET.searchValue|default:'' }}&page={{ request.GET.page|default:1 }}&elementsPerPage={{ request.GET.elementsPerPage|default:10 }}">
          Exporter Excel
        </a>
      </li>
    </ul>
  </div>

</div>


  </div>
</div>
{% endif %}
{% endblock %}

{% block content %}
{% if user.is_authenticated %}

  <!-- Tableau -->
  {% include 'compagny_information_table.html' %}

  <!-- Pagination -->
  <div class="text-center mt-3">
    <div class="input-group justify-content-center">
      <button class="btn btn-primary" type="button" onclick="updateParams(-1)">PrÃ©cÃ©dent</button>
      <span class="input-group-text">Pages</span>
      <input type="text" id="pageNumberInput" class="form-control" placeholder="NumÃ©ro de page" style="max-width: 150px;">
      <button class="btn btn-primary" type="button" onclick="goToPage()">Aller</button>
      <button class="btn btn-primary" type="button" onclick="updateParams(1)">Suivant</button>
    </div>
  </div>

{% endif %}
{% endblock %}
